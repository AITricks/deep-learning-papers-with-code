# ASCNet (arXiv:2401.15578v3) 博士生风格的研究分析报告

---

### 1. 核心思想

该工作提出了一种名为 ASCNet (Asymmetric Sampling Correction Network) 的新型红外图像去条纹方法。其核心思想在于构建一个非对称采样的 U-Net 架构，以解决传统基于小波的 U-Net 中存在的“跨层级列语义鸿沟”问题。ASCNet 创新性地使用**残差哈尔离散小波变换 (RHDWT)** 作为下采样器，以融合条纹的方向先验和数据驱动的语义特征；同时，它抛弃了传统的逆小波变换 (IDWT)，转而采用**像素重组 (Pixel Shuffle, PS)** 作为上采样器，以实现无语义偏差的图像重建。网络中还嵌入了**列非均匀性校正模块 (CNCM)**，用于捕获全局的列相关性和长程依赖，从而精确地分离条纹噪声和背景细节。

### 2. 背景与动机

红外 (IR) 成像系统广泛应用于监控、检测等领域，但其焦平面阵列 (FPA) 的非均匀响应和列信号读出机制，极易引入垂直的条纹噪声。这种噪声严重降低了图像质量，并干扰了下游任务（如红外弱小目标检测, IRSTD）的性能。

现有的深度学习方法，特别是 U-Net 架构，在去条纹任务上取得了进展。其中，一些工作尝试利用离散小波变换 (DWT) 作为下采样器，因为它能将条纹噪声的能量（主要在水平梯度上）有效聚合到低频 ($P_{ll}$) 和水平高频 ($P_{hl}$) 子带中。

然而，该工作指出了现有方法的**三个核心挑战 (Motivation)**：

1.  **IDWT 导致的跨层级列语义鸿沟**：
    在标准的小波 U-Net (DWT/IDWT) 中，虽然 DWT 在输入端分离了条纹，但经过 CNN 层的信道信息交互后，条纹噪声会“交叉污染” (Crosstalk) 到本应干净的垂直 ($K_{lh}$) 和对角 ($K_{hh}$) 梯度子带中。当 IDWT 作为上采样器时，它依赖一个“预定的”子带分布（即假设 $K_{lh}$ 和 $K_{hh}$ 是干净的），这个假设此时已不成立。这种错误的先验解码导致了跨层级的语义中断和列响应的偏差，最终重建的图像偏离了真实的列分布。

2.  **独立下采样分支的表征能力不足**：
    单独使用 DWT 作为下采样器，虽然引入了方向先验，但它只在空间维度采样，缺乏信道间的语义交互。而单独使用步进卷积 (Stride Convolution)，虽然考虑了语义特征，却忽略了条纹噪声的方向先验。

3.  **特征增强未能捕获全局列特征**：
    现有的注意力机制或校正模块，虽然尝试建模列特征，但缺乏对“全局上下文”中“长程依赖” (long-range dependencies) 的显式建模，导致无法在全局范围内有效地区分条纹和场景的垂直结构。

ASCNet 的设计正是为了系统性地解决上述三个问题。

### 3. 主要贡献点

该工作的主要贡献可归纳为以下三点：

1.  **提出非对称采样 (DWT/PS) 架构，解决语义鸿沟问题**。
    * **核心差异**：针对 DWT/IDWT 对称采样导致的语义鸿沟，ASCNet 提出了“非对称”思想。它保留了 DWT 作为下采样器以利用其条纹分离能力，但用 Pixel Shuffle (PS) 替换了 IDWT 作为上采样器。
    * **工作机理**：PS 是一种“无语义偏差” (semantic-bias-free) 的上采样器。它不依赖任何像 IDWT 那样的线性计算和先验假设（即哪些子带应该代表什么）。相反，PS 只是直接重新排列 (reorganizes) 低分辨率特征图的像素到高分辨率空间。
    * **效果**：这种“较弱的先验假设” 使得 PS 能够更好地衔接被 CNN 污染的特征，保持了稳定的列语义波动，从而实现了更准确、无语义偏差的图像重建。

2.  **设计 RHDWT 下采样器，融合方向先验与语义交互**。
    * **核心差异**：针对传统 DWT 缺乏语义交互 和步进卷积缺乏方向先验 的问题，该工作提出了残差哈尔离散小波变换 (RHDWT)。
    * **工作机理**：RHDWT 是一个双分支并行结构。
        1.  **模型驱动分支 (Model-driven)**：利用固定的哈尔小波 (HDWT) 滤波器分解特征，以编码条纹噪声的“方向先验知识”。
        2.  **残差分支 (Residual)**：利用一个标准的 $3 \times 3$ 步进卷积（步长为 2）来捕获“数据驱动的”跨信道语义信息。
    * **效果**：通过将两个分支的输出相加，RHDWT 实现了先验知识和数据驱动语义的有效补充，获得了比任何单一采样器都更丰富的特征表征。

3.  **设计 CNCM 模块，实现全局列特征校正**。
    * **核心差异**：针对现有注意力机制缺乏全局长程依赖建模的问题，该工作设计了列非均匀性校正模块 (CNCM)。
    * **工作机理**：CNCM 的核心是 RCSSC 块 (Residual Column Spatial Self-Correction)。RCSSC 包含三个关键分支：
        1.  **列注意力分支 (CAB)**：通过 $(H, 1)$ 核的列平均池化和列最大池化，显式地加强列特征，以克服条纹噪声的列间差异。
        2.  **空间注意力分支 (SAB)**：通过全局（信道维度）池化，增强关键区域的结构表征。
        3.  **自校准分支 (SCB)**：通过“下采样-卷积-上采样”的操作，建立灵活的“远程依赖” (remote dependencies)，聚合全局上下文信息，以微调全局均匀性。
    * **效果**：CNCM 通过整合列均匀性、空间相关性和自依赖性，能有效捕获全局上下文中的列特征，从而更好地区分条纹和背景。

### 4. 方法细节

![结构图](https://gitee.com/ChadHui/typora-image/raw/master/cv-image/20251029104821.jpg)

#### 4.1 RHDWT (Residual Haar Discrete Wavelet Transform)

RHDWT 被设计为 ASCNet 的下采样模块，它旨在解决单一采样器的局限性。

* **理念**：结合“模型驱动”的先验（Haar 小波的方向性）和“数据驱动”的语义（标准卷积的跨信道交互）。
* **机制**：
    对于输入特征 $I_i \in \mathbb{R}^{C \times H \times W}$，RHDWT 并行处理两个分支：
    1.  **模型驱动分支 (Model-driven Branch)**：
        * 首先，使用 HDWT 算子 $\Phi(\cdot)$ 对 $I_i$ 进行分解。这会产生四个子带 $S_{ll}, S_{lh}, S_{hl}, S_{hh}$，它们在信道维度被拼接 (Concatenate)。
        * 然后，使用一个 $3 \times 3$ 卷积 $f_{3\times3}^{\delta}$（后跟 LeakyReLU）来压缩信道并进行初步的语义融合。
        * 输出为：$I_{model}^{out} = f_{3\times3}^{\delta}([\Phi(I_{i})])$。
    2.  **残差分支 (Residual Branch)**：
        * 使用一个 $3 \times 3$、步长为 2 的卷积 $f_{3\times3}^{s=2}$ 直接对 $I_i$ 进行下采样。
        * 这个分支捕获了标准 CNN 擅长的空间和语义特征。
        * 输出为：$I_{res}^{out} = f_{3\times3}^{s=2}(I_{i})$。

* **总结**：
    最终的输出 $I_R$ 是两个分支的逐元素相加：
    $$I_R = I_{model}^{out} + I_{res}^{out} = f_{3\times3}^{\delta}([\Phi(I_{i})]) + f_{3\times3}^{s=2}(I_{i})$$
    这种并行结构 确保了条纹的方向先验（来自 $\Phi(\cdot)$）和数据驱动的语义（来自 $f_{3\times3}^{s=2}$）被同时保留和增强。

#### 4.2 CNCM (Column Non-uniformity Correction Module)

CNCM 是网络中的核心特征增强单元。

* **理念**：条纹噪声在列上具有一致性，但在全局上又具有非均匀性。因此，模块需要同时建模“列特性”、“空间结构”和“全局长程依赖”。
* **机制 (RCSSC 块)**：
    RCSSC 块接收输入 $X \in \mathbb{R}^{C \times H \times W}$，并并行通过三个分支：

    1.  **CAB (Column Attention Branch)**：
        * **目标**：强化列特征，使同一列内的像素获得相似的校正系数。
        * **流程**：
            a.  使用 $(H, 1)$ 核的列平均池化 ($f_{column}^{Avg}$) 和列最大池化 ($f_{columm}^{Max}$) 分别作用于 $X$，得到两个 $ \mathbb{R}^{C \times 1 \times W}$ 的列描述子。
            b.  拼接 (Concatenate) 二者得到 $M_c \in \mathbb{R}^{2C \times 1 \times W}$。
            c.  $M_c$ 经过共享的 1x1 卷积 (CBL) 后，被拆分 (Split) 为两个分支 $X_a$ 和 $X_m$。
            d.  $X_a$ 和 $X_m$ 分别经过各自的信道注意力模块（Conv+BN+ReLU+Conv+Sigmoid），生成列注意力权重。
            e.  最终输出 $CA$ 是输入 $X$ 与这两个权重（广播后）的乘积。
        * **创新**：CAB 采用了双池化 (Avg+Max)、特征拆分和双重校正策略 (dual-correction)，获得了更好的性能。

    2.  **SAB (Spatial Attention Branch)**：
        * **目标**：增强关键区域的“空间相关性”。
        * **流程**：这是一个标准的空间注意力模块。它对输入 $X$ 沿信道维度进行全局平均池化 ($f_{spatial}^{Avg}$) 和最大池化 ($f_{spatial}^{Max}$)。将两者拼接后，通过一个 $3 \times 3$ 卷积和 Sigmoid 激活函数 $f_{3\times3}^{s}$ 生成空间掩码。
        * 输出为：$SA = f_{3\times3}^{s}([f_{spatial}^{Avg}(X), f_{spatial}^{Max}(X)]) \odot X$。

    3.  **SCB (Self-Calibrated Branch)**：
        * **目标**：建立“长程依赖” (long-range dependencies)，聚合全局上下文信息。
        * **流程**：
            a.  使用 $2 \times 2$ 平均池化 $\mathcal{H}_2(\cdot)$ 对 $X$ 进行下采样。
            b.  通过卷积 $conv(\cdot)$ 提取上下文特征。
            c.  使用双线性插值 $\mathcal{B}_2(\cdot)$ 上采样回原始分辨率。
            d.  将结果与 $X$ 相加（残差连接），并通过 Sigmoid 激活 $\delta_s$ 生成调制权重 $SC$。
        * 输出为：$SC = \delta_s(X + \mathcal{B}_2(conv(\mathcal{H}_2(X))))$。

* **总结 (RCSSC)**：
    三个分支的输出被融合。CAB 和 SAB 的输出被拼接并通过 $1 \times 1$ 卷积 $f_{1\times1}$ 融合，然后与 SCB 的输出（作为调制器）进行 Hadamard 乘积 ( $\odot$ )。最后，通过残差连接加上原始输入 $X$：
    $$C_o = f_{1\times1}([SA, CA]) \odot SC + X$$
    这个设计确保了模块能同时关注列、空间和全局上下文三个维度的信息。

### 5. 即插即用模块的作用、适用场景和应用

ASCNet 中的 RHDWT 和 CNCM (RCSSC) 模块具有很强的通用性，可以作为即插即用 (Plug-and-Play) 模块应用于其他网络和任务。

#### 5.1 RHDWT (下采样模块)

* **作用**：
    替代标准的下采样层（如 $3 \times 3$ 步进卷积或 Max Pooling）。
* **适用场景**：
    1.  **具有强方向性先验的任务**：当处理的图像或特征中包含已知的、固定的方向性结构（如条纹、雨丝、扫描线、Moiré 图案）时。
    2.  **需要保留先验和语义的任务**：当既需要利用固定的物理先验（如小波分解）又需要学习数据驱动的深度语义特征时。
* **具体应用**：
    1.  **图像恢复**：
        * **图像去雨 (Deraining)**：雨丝具有明显的方向性，RHDWT 可以融合雨丝的方向先验和场景的语义。
        * **去摩尔纹 (Demoiréing)**：Moiré 图案也常具有固定的高频方向性。
        * **去隔行扫描线 (Deinterlacing)**：处理隔行扫描视频产生的水平线伪影。
    2.  **特征提取**：
        * **语义分割/目标检测**：用于处理具有高度结构化方向的场景，如城市场景（建筑物的垂直边缘、道路的水平边缘）或遥感图像中的农田。

#### 5.2 CNCM / RCSSC (特征增强模块)

* **作用**：
    替代标准的特征增强块（如 ResBlock、SE-Net 模块、CBAM）。
* **适用场景**：
    1.  **各向异性 (Anisotropic) 特征建模**：当特征在某一维度（如列或行）上的相关性远大于其他维度时。CNCM 的 CAB 分支 专门用于处理这种“列相关性”。
    2.  **需要全局上下文校正的任务**：当局部感受野不足以区分噪声/伪影和真实结构，需要长程依赖 和全局信息 进行校正时（由 SCB 和 SAB 提供）。
    3.  **传感器非均匀性校正**：适用于校正由传感器（如 FPA）硬件特性引起的、具有空间相关性的固定模式噪声。
* **具体应用**：
    1.  **图像恢复**：
        * **红外图像去条纹 (Destriping)**：（本文应用）。
        * **遥感图像校正**：校正遥感图像中的传感器条带噪声。
        * **医疗影像伪影去除**：去除 CT 或 MRI 中的环状伪影或运动伪影（如果它们表现出某种空间相关性）。
    2.  **下游视觉任务（作为预处理或网络内部模块）**：
        * **红外弱小目标检测 (IRSTD)**：CNCM 能有效抑制条纹噪声，提高目标的信噪比 (SNR)，从而提升下游检测器的检测概率和 F-measure。
        * **低光照图像增强**：低光照下传感器噪声（包括列噪声）更明显，CNCM 可用于在增强亮度的同时抑制噪声。